apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'jetty'
apply plugin: 'eclipse'

repositories {
    mavenLocal()
    mavenRepo url: "${repoUrl}/groups/public"
}

def slf4jVersion = '1.6.4'
def jettyVersion = '7.5.4.v20111024'

dependencies {
    compile group: 'com.timgroup', name: 'Tucker', version: '+'
    providedCompile group: 'javax.servlet', name: 'servlet-api', version: '2.5'
    
    runtime group: 'org.slf4j', name: 'slf4j-simple', version: slf4jVersion

    compile group: 'org.eclipse.jetty',        name: 'jetty-server',               version: jettyVersion
    compile group: 'org.eclipse.jetty',        name: 'jetty-webapp',               version: jettyVersion
    compile group: 'commons-io',               name: 'commons-io',                 version: '1.4'
}

jar {
    enabled=true
    from configurations.runtime.collect{
        zipTree(it).matching {
            exclude 'META-INF/METAFEST.MF'
            exclude 'META-INF/*.SF'
            exclude 'META-INF/*.DSA'
            exclude 'META-INF/*.RSA'
        }
    }
    exclude '*.conf'
    from sourceSets.main.output
    manifest { 
        attributes("Main-Class": "infrastructure.JettyLauncher") 
        attributes("Implementation-Version": "The.reported.version")
    }
}

httpPort = 8888

eclipse {
    classpath {
        defaultOutputDir = file('.eclipse')
    }
}
