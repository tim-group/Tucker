apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'jetty'
apply plugin: 'eclipse'
apply plugin: 'application'

repositories {
    mavenLocal()
    mavenRepo url: "${repoUrl}/groups/public"
}

ext {
    slf4jVersion = '1.7.13'
    jettyVersion = '8.1.18.v20150929'
}

dependencies {
    compile group: 'com.timgroup', name: 'Tucker', version: '+'

    runtime group: 'org.slf4j', name: 'slf4j-simple', version: slf4jVersion

    compile group: 'org.eclipse.jetty',        name: 'jetty-server',               version: jettyVersion
    compile group: 'org.eclipse.jetty',        name: 'jetty-servlet',              version: jettyVersion
    compile group: 'commons-io',               name: 'commons-io',                 version: '1.4'
}

mainClassName = 'infrastructure.JettyLauncher'

jar {
    enabled=true
    from configurations.runtime.collect{
        zipTree(it).matching {
            exclude 'META-INF/METAFEST.MF'
            exclude 'META-INF/*.SF'
            exclude 'META-INF/*.DSA'
            exclude 'META-INF/*.RSA'
        }
    }
    exclude '*.conf'
    from sourceSets.main.output
    manifest { 
        attributes("Main-Class": mainClassName)
        attributes("Implementation-Version": "The.reported.version")
    }
}

httpPort = 8888

eclipse {
    classpath {
        defaultOutputDir = file('.eclipse')
    }
}

run {
    args httpPort
}
